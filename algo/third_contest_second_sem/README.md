A. Острова
Все языки	Python 3.12.1
Ограничение времени	0.5 секунд	2 секунды
Ограничение памяти	16.0 Мб	32.0 Мб
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Одно разбросанное на островах Океании государство решило создать сеть автомобильных дорог (вернее, мостов). По каждому мосту можно перемещаться в обе стороны. Был разработан план очередности строительства мостов и известно, что после постройки всех мостов можно будет проехать по ним с каждого острова на каждый (возможно, через некоторые промежуточные острова).

Однако, этот момент может наступить до того, как будут построены все мосты. Ваша задача состоит в определении такого минимального количества мостов, после постройки которого (в порядке строительства по плану) можно будет попасть с любого острова на любой другой.

Формат ввода
Первая строка содержит два числа: 
Unexpected text node: '
                            
                        '
N - число островов 
Unexpected text node: '
                            
                        '
(1≤N≤100000) и 
Unexpected text node: '
                            
                        '
M - количество мостов в плане 
Unexpected text node: '
                            
                        '
(1≤M≤200000). В каждой следующей строке содержится описание моста - два числа 
Unexpected text node: '
                            
                        '
x и 
Unexpected text node: '
                            
                        '
y 
Unexpected text node: '
                            
                        '
(0≤x,y<N) - номера соединяемых островов.

Формат вывода
Выведите в выходной файл одно число - минимальное количество построенных мостов, по которым можно попасть с любого острова на любой.

B. Вес компоненты
Все языки	Python 3.12.1
Ограничение времени	1 секунда	15 секунд
Ограничение памяти	32Mb	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
В неориентированный взвешенный граф добавляют ребра. Напишите программу, которая в некоторые моменты находит сумму весов ребер в компоненте связности.

Формат ввода
В первой строке записано два числа n и m (1 ≤ n, m ≤ 106) — количество вершин в графе и количество производимых добавлений и запросов. Далее следует m строк с описанием добавления или запроса. Каждая строка состоит из двух или четырех чисел.

Первое из чисел обозначает код операции. Если первое число 1, то за ним следует еще три числа x, y, w. Это означает, что в граф добавляется ребро xy веса w (1 ≤ x < y ≤ n, 1 ≤ w ≤ 1000). Кратные ребра допустимы.

Если первое число 2, то за ним следует ровно одно число x. Это означает, что необходимо ответить на вопрос, какова сумма весов ребер в компоненте связности, которой принадлежит вершина x (1 ≤ x ≤ n).

Формат вывода
Для каждой операции с кодом 2 выведите ответ на поставленную задачу. Ответ на каждый запрос выводите на отдельной строке.

C. Прим
Ограничение времени	0.5 секунд
Ограничение памяти	32Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Требуется найти в связном графе остовное дерево минимального веса. Задачу решайте с помощью алгоритма Прима

Формат ввода
Первая строка входного файла содержит два натуральных числа n и m — количество вершин и ребер графа соответственно (1 ≤ n ≤ 20000, 0 ≤ m ≤ 100000). Следующие m строк содержат описание ребер по одному на строке. Ребро номер i описывается тремя натуральными числами bi, ei и wi — номера концов ребра и его вес соответственно (1 ≤ bi, ei ≤ n, 0 ≤ wi ≤ 100000).

Формат вывода
Выведите единственное целое число — вес минимального остовного дерева.

D. Краскал
Ограничение времени	1.5 секунд
Ограничение памяти	128Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Дан связный неориентированный граф, в котором надо найти остовное дерево минимального веса с помощью алгоритма Краскала. Гарантируется, что ребра будут отсортированы по весу по неубыванию.

Формат ввода
В первой строке идут два натуральных числа N и M (2 ≤ N ≤ 5 ⋅ 104, 1 ≤ M ≤ 2 ⋅ 106). Далее идет M строк — описания ребер в формате u, v, w (1 ≤ u < v ≤ N, 1 ≤ w ≤ 104) — ребро между вершинами u и v веса w.

Формат вывода
Вывести вес минимального остового дерева.

E. Борувка
Ограничение времени	2 секунды
Ограничение памяти	128Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Дан связный неориентированный граф, в котором надо найти остовное дерево минимального веса с помощью алгоритма Борувки.

Формат ввода
В первой строке идут два натуральных числа N и M (2 ≤ N ≤ 5 ⋅ 104, 1 ≤ M ≤ 2 ⋅ 106). Далее идет M строк — описания ребер в формате u, v, w (1 ≤ u < v ≤ N, 1 ≤ w ≤ 109) — ребро между вершинами u и v веса w.

Формат вывода
Вывести вес минимального остового дерева.

F. Шпионы
Ограничение времени	1 секунда
Ограничение памяти	128Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Вы — глава агенства, в котором работает N сотрудников — шпионы с кодовыми номерами от 1 до N. Шпионы были посланы в различные страны и получили кусочки важной информации. Ваша задача состоит в следующем:

Организовать встречи между некоторыми шпионами. На каждой такой встрече ровно два шпиона оказываются в одном месте и обмениваются всей информацией, которую получили сами или узнали от других шпионов на предыдущих встречах. Каждую из возможных встреч сложно и затратно организовать, поэтому вам известны все стоимости.
После того, как все встречи состоялись, выбирается группа шпионов, и они посылаются на задание по спасению мира. Для каждого шпиона известно, сколько денег он изведет, если его включить в эту группу. Задание должно быть выполнено, поэтому очень важно, чтобы выбранные шпионы все вместе обладали всей информацией, полученной агенством.
Найдите минимальную цену, за которую можно спасти мир.

Формат ввода
Первая строка содержит натуральное число N — количество шпионов (2 ≤ N ≤ 1000). Каждая из следующих строк содержит N натуральных чисел, не превосходящих 106. Число в k-й строке и m-м столбце обозначает стоимость встречи между шпионами k и m и совпадает с числом в m-й строке и k-м столбце (если k = m, то соответствующее число будет равно 0). Следующая строка содержит n чисел, i-е из них равно стоимости послать i-го шпиона на задание. Все стоимости являются положительными целыми числами.

Формат вывода
Выведите одно число — минимальную стоимость спасения мира.

G. Предатель отрицательного веса
Ограничение времени	0.2 секунды
Ограничение памяти	16Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Вы член команды на космическом корабле в игре Among Us. Однако, один из ваших товарищей — скрытый враг, который пытается помешать вам выполнить миссию. Ваша задача — найти кратчайшие пути от вашей текущей позиции на вершине 1 до каждой другой вершины в графе.

Граф содержит отрицательно взвешенные ребра, но при этом не имеет отрицательных циклов. Это означает, что вам не нужно беспокоиться о бесконечном цикле отрицательного веса, который мог бы затянуть вашу команду в бесконечный круг. Однако, вы все еще должны быть осторожны и находиться начеку, чтобы избежать других ловушек, которые может подготовить скрытый враг, чтобы остановить вас.

Сможете ли вы обнаружить скрытого врага и найти кратчайший путь к каждой вершине, чтобы выполнить миссию команды и спасти корабль?

Формат ввода
Число вершин равно N (1 ≤ N ≤ 100), а число ребер равно M (0 ≤ M ≤ 10000). В следующих строках идет M троек чисел, описывающих ребра: начало, конец и вес (целое число от -100 до 100).

Формат вывода
Программа должна вывести N чисел — веса кратчайших путей от вершины 1 до всех остальных. Если нельзя прийти от первой вершины до некоторой, то вместо усилия выведите число 30000.

H. Авиаперелеты
Ограничение времени	0.3 секунды
Ограничение памяти	16Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Профессору Форду необходимо попасть на международную конференцию. Он хочет потратить на дорогу наименьшее количество денег, поэтому решил, что будет путешествовать исключительно ночными авиарейсами (чтобы не тратиться на ночевку в отелях), а днем будет осматривать достопримечательности тех городов, через которые он будет проезжать транзитом. Он внимательно изучил расписание авиаперелетов и составил набор подходящих авиарейсов, выяснив, что перелеты на выбранных направлениях совершаются каждую ночь и за одну ночь он не сможет совершить два перелета.

Теперь профессор хочет найти путь наименьшей стоимости, учитывая что до конференции осталось K ночей (то есть профессор может совершить не более K перелетов).

Формат ввода
В первой строке находятся числа N (2 ≤ N ≤ 100) (количество городов), M (1 ≤ M ≤ 105) (количество авиарейсов), K (1 ≤ K ≤ 100) (количество оставшихся ночей), S (1 ≤ S ≤ N) (номер города, в котором живет профессор), F (1 ≤ F ≤ N) (номер города, в котором проводится конференция).

Далее идет M строк, задающих расписание авиарейсов. i-я строка содержит три натуральных числа: Si, Fi и Pi, где Si — номер города, из которого вылетает i-й рейс, Fi — номер города, в который прилетает i-й рейс, Pi  — стоимость перелета i-м рейсом. Гарантируется, что 1 ≤ Si ≤ N, 1 ≤ Fi ≤ N, 1 ≤ Pi ≤ 106.

Формат вывода
Выведите одно число — минимальную стоимость пути, подходящего для профессора. Если профессор не сможет за K ночей добраться до конференции, выведите число -1.

I. Дейкстра
Ограничение времени	1.5 секунд
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
В этой задаче вы являетесь членом команды на космическом корабле в игре "Among Us". На корабле имеется N комнат, каждая из которых представлена вершиной в графе. Вы и ваши командные товарищи пытаетесь выполнять задания и поддерживать работоспособность корабля, но среди вас есть подлец, который пытается помешать вам.

Подлец взломал навигационную систему корабля и создал K графов, представляющих различные карты расположения комнат на корабле. Ваша задача состоит в том, чтобы найти кратчайший путь от вашего текущего местоположения до каждой из других комнат.

Каждая вершина представляет комнату на корабле, а каждое ребро представляет коридор, соединяющий две соседние комнаты. Вес каждого ребра представляет время, необходимое для перемещения между комнатами.

Сможете ли вы и ваши товарищи по команде пройти по кораблю и выполнить свои задания?

Формат ввода
В первой строке входных данных задано число K — количество различных карт комнат на корабле, где герои могут находиться. Далее следуют K блоков, каждый из которых имеет следующую структуру.

Первая строка блока содержит два числа N и M, разделенные пробелом — количество комнат и переходов. Далее следуют M строк, каждая из которых содержит по три целых числа, разделенные пробелами. Первые два из них в пределах от 0 до N - 1 каждое и обозначают комнаты на концах соответствующего перехода, третье — в пределах от 0 до 20000 и обозначает длину этого коридора. Далее, в последней строке блока, записанное единственное число от 0 до N - 1 — вершина, где вы расположены.

Количество различных карт в одном тесте K не превышает 5. Количество вершин не превышает 60000, рёбер — 200000.

Формат вывода
Выведите в стандартный вывод K строк, в каждой из которых по Ni чисел, разделенных пробелами — расстояния от указанной начальной комнаты до его 0-й, 1-й, 2-й и т. д. комнат (допускается лишний пробел после последнего числа). Если некоторая комната недостижима от указанной начальной, вместо расстояния выводите число 2009000999 (гарантировано, что все реальные расстояния меньше).

J. Еще раз Дейкстра
Ограничение времени	1 секунда
Ограничение памяти	128Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Дан ориентированный граф, рёбрам которого приписаны некоторые неотрицательные веса (длины). Найти длину кратчайшего пути из вершины s в вершину t.

Формат ввода
В первой строке заданы три числа: число вершин в графе N (N ≤ 2 ⋅ 103), номера вершин s и t. Далее идёт матрица смежности графа, то есть N строк, в каждой из которых записано N чисел. j-е число в i-й строке матрицы смежности задает длину ребра, ведущего из i-й вершину в j-ю. Длины могут принимать любые значения от 0 до 106, число -1 означает отсутствие соответствующего ребра. Гарантируется, что на главной диагонали матрицы стоят нули.

Формат вывода
Выведите одно число — минимальную длину пути. Если пути не существует, выведите -1.

K. Циклический саботаж
Ограничение времени	0.1 секунда
Ограничение памяти	16Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Вы являетесь членом команды на космическом корабле. Ваша задача — убедиться, что все системы функционируют должным образом и корабль может выполнить свою миссию. Однако вы получили сообщение от подозрительного члена экипажа, что в одной из систем есть саботаж.

Как член команды, вы знаете, что саботаж может негативно сказаться на миссии корабля. В командном центре корабля есть компьютер, который показывает общую производительность корабля.

Вам нужно написать программу, которая проверяет, есть ли саботаж в какой-либо из систем корабля, который может повлиять на миссию корабля. Вы можете представить системы корабля в виде ориентированного графа, где каждое ребро имеет вес. Отрицательный вес означает наличие (и степень) саботажа в этой системе, а положительный вес означает работоспособность (и надежность) системы.

Если в системе корабля найдется цикл отрицательного веса, то саботаж успешен.

Формат ввода
В первой строке содержится число N (1 ≤ N ≤ 100) — количество вершин графа системы. В следующих N строках находится по N чисел — матрица смежности графа. Веса ребер по модулю меньше 100000. Если ребра нет, соответствующее значение равно 100000.

Формат вывода
В первой строке выведите YES, если цикл существует, или NO, в противном случае.

При наличии цикла выведите во второй строке количество вершин в нем (считая одинаковые — первую и последнюю), а в третьей строке — вершины, входящие в этот цикл, в порядке обхода. Если циклов несколько, то выведите любой из них.

L. Джонсон
Ограничение времени	1 секунда
Ограничение памяти	16Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Урбанист Варлам Ильинов каждый день катается на своем велосипеде по городу, оценивая качество велосипедных дорог, а также доступность его любимых кофеен. За годы своих трудов он смог составить подробную карту каждого района и выяснить за какое время он сможет добраться от одной кофейни до другой. Кроме того, если от одной кофейни до другой есть трамвайная линия, то он впадает в неистовый восторг и считает, что время на этом пути не тратится, а наоборот приобретается.

Теперь он хочет измерить удобность транспортной инфраструктуры. Чем меньше максимальное расстояние между кофейнями, тем более удобным считается город. При этом, если от одной кофейни нельзя добраться до другой ни по велосипедным дорожкам, ни с помощью трамвая, то такая (упорядоченная) пара игнорируется при подсчете удобности.

Необходимо найти пару кофеен, кратчайшее расстояние от одной из которых до другой максимально среди всех пар, между которыми есть какой-либо путь.

Формат ввода
В первой строке вводятся числа N и M (1 ≤ N ≤ 103, 1 ≤ M ≤ 5 ⋅ N) — количество кофеен и общее количество велосипедных дорожек и трамвайных путей. В следующих M строках задаются числа a, b, w, что означает наличие пути от кофейни a до кофейни b длины w ∈ [-100, 100] (но не наоборот!). Кофейни нумеруются с 0. Кольцевых трамвайных линий в городе не предусмотрено.

Формат вывода
Выведите искомое максимальное конечное кратчайшее расстояние между кофейнями.

M. Флойд-Уоршелл
Ограничение времени	0.2 секунды
Ограничение памяти	16Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Полный ориентированный взвешенный граф задан матрицей смежности. Постройте матрицу кратчайших путей между его вершинами. Гарантируется, что в графе нет циклов отрицательного веса.

Формат ввода
В первой строке вводится единственное число N (1 ≤ N ≤ 100) — количество вершин графа. В следующих N строках по N чисел задается матрица смежности графа (j-е число в i-й строке соответствует весу ребра из вершины i в вершину j). Все числа по модулю не превышают 100. На главной диагонали матрицы всегда нули.

Формат вывода
Выведите N строк по N чисел — матрицу кратчайших расстояний между парами вершин. j-е число в i-й строке должно быть равно весу кратчайшего пути из вершины i в вершину j.

N. Форд-Фалкерсон
Все языки	Python 3.12.1
Ограничение времени	1.5 секунд	10 секунд
Ограничение памяти	16Mb	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Задан ориентированный граф, каждое ребро которого обладает целочисленной пропускной способностью. Найдите максимальный поток из вершины с номером 1 в вершину с номером n.

В этой задаче необходимо реализовать алгоритм Форда-Фалкерсона.

Формат ввода
Первая строка входного файла содержит n и m — количество вершин и количество ребер графа (2 ≤ n ≤ 100, 1 ≤ m ≤ 1000). Следующие m строк содержат по три числа: номера вершин, которые соединяет соответствующее ребро графа и его пропускную способность. Пропускные способности не превосходят 105.

Формат вывода
В выходной файл выведите одно число — величину максимального потока из вершины с номером 1 в вершину с номером n.

O. Эдмондс-Карп
Все языки	Python 3.12.1
Ограничение времени	0.1 секунда	5 секунд
Ограничение памяти	16Mb	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Задан ориентированный граф, каждое ребро которого обладает целочисленной пропускной способностью. Найдите максимальный поток из вершины с номером 1 в вершину с номером n.

В этой задаче необходимо реализовать алгоритм Эдмондса-Карпа.

Формат ввода
Первая строка входного файла содержит n и m — количество вершин и количество ребер графа (2 ≤ n ≤ 500, 1 ≤ m ≤ 10000). Следующие m строк содержат по три числа: номера вершин, которые соединяет соответствующее ребро графа и его пропускную способность. Пропускные способности не превосходят 109.

Формат вывода
В выходной файл выведите одно число - величину максимального потока из вершины с номером 1 в вершину с номером n.

P. Химия
Ограничение времени	0.5 секунд
Ограничение памяти	16Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Вася и Сережа играют в следующую игру. В некоторых клетках клетчатого листка Сережа рисует один из символов H, O, N или C, после чего Вася должен провести между некоторыми находящимися в соседних клетках символами линии так, чтобы получилось корректное изображение химической молекулы. К сожалению, Сережа любит рисовать много символов, и Вася не может сразу определить, возможно ли вообще нарисовать линии нужным способом. Помогите ему написать программу, которая даст ответ на этот вопрос.

В этой задаче проведенные между символами химических элементов линии будем считать корректным изображением молекулы, если они удовлетворяют следующим условиям:

каждая линия соединяет символы, нарисованные в соседних (по стороне) клетках;
между каждой парой символов проведено не более одной линии;
от каждого элемента отходит ровно столько линий, какова валентность этого элемента (1 для H, 2 для O, 3 для N, 4 для C);
пустые клетки ни с чем не соединены;
хотя бы в одной клетке нарисован какой-то символ.
Формат ввода
Первая строка входного файла содержит два натуральных числа n и m (1 ≤ n, m ≤ 50) — размеры листочка, на котором рисует Сережа.

Далее следуют n строк по m символов в каждой, задающих конфигурацию химических элементов, которую нарисовал Сережа; пустые клетки задаются символом «.».

Формат вывода
В выходной файл выведите одно слово Valid, если линии провести требуемым образом можно, и Invalid, если нельзя.

Q. Диниц
Все языки	Python 3.12.1
Ограничение времени	0.15 секунд	1 секунда
Ограничение памяти	16Mb	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Задан ориентированный граф, каждое ребро которого обладает целочисленной пропускной способностью. Найдите максимальный поток из вершины с номером 1 в вершину с номером n.

В этой задаче необходимо реализовать алгоритм Диница.

Формат ввода
Первая строка входного файла содержит n и m — количество вершин и количество ребер графа (2 ≤ n ≤ 500, 1 ≤ m ≤ 10000). Следующие m строк содержат по три числа: номера вершин, которые соединяет соответствующее ребро графа и его пропускную способность. Пропускные способности не превосходят 109.

Формат вывода
В выходной файл выведите одно число - величину максимального потока из вершины с номером 1 в вершину с номером n.

R. Маховик сюжета
Ограничение времени	0.2 секунды
Ограничение памяти	16Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
# include "отказ_от_авторских_прав.h"

Поможем Джоан Роулинг развить сюжетную дыру, связанную с маховиками времени. После битвы с тем-кого-нельзя-называть магия вышла на качественно новый уровень. Теперь маховики времени способны не только переносить назад во времени, но и в принципе перемещаться в любую заданную точку мира в любой заданный момент времени. В связи с тем, что это могло бы вызвать хаос, Министерство Магии решило наложить некоторые ограничения на них.

А именно, есть N магических станций, в которых возможно использование маховиков, при этом любая телепортация может совершаться только в один из этих пунктов. При этом для телепортаций есть определенное расписание. Можно сравнить это с магловскими авиаперелетами, только время работает на руку волшебникам.

Легенда закончена, теперь сама задача. В момент времени 0 вы находитесь в магической станции A. Вам дано расписание рейсов. Требуется оказаться в магической станции B как можно раньше (то есть в наименьший возможный момент времени).

При этом разрешается делать сложные маршруты, использующие несколько магических станций. Если вы прибываете на некоторую станцию в момент времени T, то вы можете телепортироваться из него любым рейсом, который отправляется из этой станции в момент времени T или позднее (но не раньше).

Формат ввода
В первой строке вводится число N — количество магических станций (1 ≤ N ≤ 1000). Вторая строка содержит два числа A и B — номера начальной и конечной станций. В третьей строке задается K — количество всевозможных телепортаций (0 ≤ K ≤ 1000).

Следующие K строк содержат описания телепортаций, по одной на строке. Каждое описание представляет собой четверку целых чисел. Первое число каждой четверки задает номер станции отправления, второе — время отправления, третье — станция назначения, четвертое — время прибытия. Номера станций — натуральные числа из диапазона от 1 до N.

Станции назначения и отправления могут совпадать (да-да, петли в пространстве и времени). Время измеряется в некоторых магических единицах и задается целым числом, по модулю не превышающим 109. Поскольку телепортации совершаются с использованием маховиков времени, то время прибытия может быть как больше времени отправления, так и меньше, или равным ему.

Гарантируется, что входные данные таковы, что добраться из станции A до станции B всегда можно.

Формат вывода
Выведите минимальное время, когда вы сможете оказаться в пункте B.

S. Дешифровка по палубам
Ограничение времени	1 секунда
Ограничение памяти	256Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
На космической станции возникла проблема — секретный диск, который хранится в хранилище на палубе 1, был зашифрован. Для его расшифровки требуется доставить его в офис на палубе N. Однако система безопасности изменила условия перемещения на корабле. Теперь за проход по лестнице на один этаж вверх требуется заплатить U единиц, за спуск на один этаж — D единиц

На борту имеется L телепортов, каждый из которых перемещает вас только на определенные палубы, за вход в телепорт требуется I единиц, за выход из телепорта J единиц.

Помогите команде раскрыть секрет, разработав наименьшее по стоимости путешествие с хранилища на первой палубе до офиса на палубе N.

Формат ввода
В первой строке входного файла записаны целые числа N, U, D, I, J, L.

Каждая из следующих L строк описывает соответствующий телепорт. Она начинается с числа Ki — количества палуб, на которых останавливается i-й телепорт, за которым следует Ki натуральных чисел — палубы, на которых останавливается этот телепорт (палубы для каждого телепорта задаются в возрастающем порядке).

Ограничения: 0 ≤ U ≤ 103, 0 ≤ D ≤ 103, 0 ≤ I ≤ 103, 0 ≤ J ≤ 103, 0 ≤ L ≤ 500, 1 ≤ N ≤ 106, 2 ≤ Ki ≤ 103, K1 + K2 + … +KL ≤ 105.

Количество палуб не превосходит 106.

Формат вывода
В выходной файл выведите одно число — минимальную стоимость подъема.

T. Распространение вируса
Все языки	Java 21 (Temurin JDK)
Ограничение времени	1 секунда	4 секунды
Ограничение памяти	64Mb	256Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
В этой задаче вы являетесь членом экипажа космического корабля в популярной игре Among Us. К сожалению, на корабле был запущен вирус, и теперь вам нужно добраться до медицинской комнаты в вершине t, чтобы найти лекарство.

Корабль представлен положительно взвешенным неориентированным графом, и вы начинаете в вершине s. Однако, на корабле есть k источников вируса, которые могут блокировать некоторые ребра в графе. Вес ребра равен времени, необходимому для заражения ребра.

Ваша скорость равна скорости распространения вируса, что означает, что вы можете двигаться так быстро, как и распространяется вирус. Сможете ли вы найти лекарство для вируса и спасти корабль до того, как будет слишком поздно? Ваша цель — найти кратчайший путь до вершины t, избегая блокированных ребер, вызванных источниками воды, и зараженных областей на корабле.

Формат ввода
В первой строке входных данных содержится три целых числа N, M и k — количество вершин, ребер и источников вируса (2 ≤ N ≤ 2 ⋅ 105, 0 ≤ M ≤ 2 ⋅ 105, 1 ≤ K < N).

Во второй строке содержится K различных чисел ai — номера зараженных вершин в корабле (1 ≤ ai ≤ N).

Следующие M строк описывают ребра. Каждое описание состоит из трех чисел xi, yi и li, обозначающих номера вершин, которые соединяет i-е ребро, и его длину (1 ≤ xi, yi ≤ N, 1 ≤ li ≤ 109, xi ≠ yi).

В последней строке входных данных содержится 2 числа s и t — номера вершин, где находитесь вы и лекарство (1 ≤ s, t ≤ N).

Формат вывода
Выведите единственное число — минимальное количество единиц времени, которое требуется для получения лекарства, либо «-1», если нет шансов.

U. Лекции от А
Ограничение времени	0.5 секунд
Ограничение памяти	16Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Некий А. собирается выступить с лекциями по всему миру. Он знает, что постоянно нервничает при перелетах. На некоторых маршрутах он теряет вес от волнения, а на других — много ест и набирает вес.

Известно, что чем больше весит А., тем лучше он прочтет лекцию, поэтому требуется спланировать перелеты так, чтобы вес А. на каждой лекции был максимально возможным. Он должен посещать города в том же порядке, в котором он читает свои лекции. При этом между лекциями он может посещать промежуточные города.

Формат ввода
Первая строка входного файла содержит три натуральных числа n, m и k — количество городов в мире, количество рейсов и количество лекций, которые он должен дать, соответственно (n ≤ 100, m ≤ 104, 2 ≤ k ≤ 104). Города пронумерованы числами от 1 до n.

Следующие m строк содержат описание рейсов, по одному на строке. Рейс номер i описывается тремя числами bi, ei и wi — номер начального и конечного города рейса и предполагаемое изменение веса А. в миллиграммах (1 ≤ bi, ei ≤ n, −105 ≤ wi ≤ 105).

Последняя строка содержит числа a1, a2, …, ak — номера городов, в которых проводятся лекции. В начале тура он находится в городе a1.

Гарантируется, что он может прочесть все лекции.

Формат вывода
Первая строка выходного файла должна содержать число s — количество рейсов, которые он должен сделать. Вторая строка должна содержать s чисел — номера используемых рейсов. Если существует такая последовательность маршрутов между концертами, что А. будет набирать вес неограниченно, то первая строка выходного файла должна содержать строку infinitely kind.

V. Оставь надежду, всяк сюда входящий
Ограничение времени	2 секунды
Ограничение памяти	32Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Абитуриент Василий решил подать документы в ФПМИ. Так как Василий живёт достаточно далеко, он решил спланировать своё путешествие заранее.

В результате долгих размышлений он пришёл к выводу, что на дорогу у него есть не более T минут, так как приёмная комиссия скоро закроется. Бюджет будущего студента также ограничен, поэтому он хочет ещё и потратить на своё путешествие поменьше денег.

После ещё более долгих размышлений Василий составил карту из всех возможных путей с промежуточными пунктами (станции общественного транспорта или другие значимые для него объекты, до которых он гарантированно может добраться из дома). Карта представляет собой список из N пунктов, где дом Василия — это пункт с номером 1, а N -й пункт — приёмная комиссия. Между пунктами существует M переходов. Для каждого из них он написал стоимость Pi и время Ti. При этом гарантируется, что он всегда может добраться до приёмной комиссии.

Между любыми двумя пунктами в карте Василия имеется не более одного прямого перехода. Некоторые из переходов могут быть бесплатными или занимать пренебрежительно малое время. При этом любой переход двусторонний, то есть стоимость перехода и время не зависят от того, движется ли Василий из пункта с номером A в пункт с номером B, или в обратном направлении.

Помогите Василию найти минимальную стоимость маршрута, благодаря которому он сможет успеть подать документы и на который он потратит меньше всего денег.

Формат ввода
В первой строке даны три числа: N — число пунктов (1 ≤ N ≤ 103), M — число переходов (1 ≤ M ≤ 5 ⋅ 104), T — максимальное время (0 ≤ T ≤ 103).

Далее идут M строк, содержащих по четыре целых неотрицательных числа — описание перехода:

Ai — номер пункта, откуда идёт переход;
Bi — номер пункта, куда приведёт переход (1 ≤ Ai, Bi ≤ N; );
Pi — стоимость перехода (0 ≤ Pi ≤ 106);
Ti — продолжительность перехода (0 ≤ Ti ≤ 103).
Формат вывода
Если добраться за отведённое время до приёмной комиссии невозможно, выведите единственное число −1.

В противном случае, в первой строке выведите минимальное количество денег, требуемое для того, чтобы Василий успел подать документы.

Во второй строке выведите L — число переходов, по которым Василию нужно пройти, чтобы успеть.

В третьей строке выведите L чисел, которые задают порядок пунктов, по которому должен пройти Василий, чтобы успеть и потратить меньше всего денег.

W. Заправочный маршрут
Ограничение времени	2 секунды
Ограничение памяти	256Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
На космической станции "Скелет" имеется m воздушных труб и n отсеков (обозначенных номерами от 1 до n). Каждая воздушная труба соединяет некоторые два отсека. Более того, станция "Скелет" в такой модели является планарной. На некоторых отсеках размещены топливные склады, с которыми у команды заключен контракт о сотрудничестве.

В распоряжении команды имеются космические корабли различной вместимости, пилоты которых могут бесплатно заправляться на любом топливном складе.

Команде требуется отвечать на следующие запросы: может ли корабль вместимости b долететь от топливного склада, расположенного в отсеке x, до топливного склада, расположенного в отсеке y? Известно, что корабль вместимости b не может пролететь более b километров без дозаправки.

Напишите программу, которая бы автоматизировала ответы на подобные запросы.

Формат ввода
Первая строка входного файла содержит три целых числа n, s и m (2≤ s ≤ n ≤ 2 ⋅ 105, 1≤ m ≤ 2 ⋅ 105) — количество отсеков, количество отсеков с топливными складами и количество воздушных труб.

Вторая строка содержит s попарно различных целых чисел c1,c2, …, cs (1≤ ci ≤ n) — номера отсеков, на которых расположены топливные склады.

Следующие m строк задают воздушные трубы. i-я из этих строк содержит три целых числа ui, vi и di , обозначающие, что i-я труба имеет длину di километров и соединяет отсеки ui и vi. Каждая пара отсеков соединена не более, чем одной трубой.

Следующая строка содержит одно целое число q (1 ≤ q ≤ 2 ⋅ 105) — количество запросов.

Последующие q строк задают запросы: i-я из этих строк содержит три целых числа xi, yi и bi  — исходную точку маршрута, конечную точку маршрута и вместимость корабля. Гарантируется, что на обоих отсеках xi и yi размещены топливные склады.

Формат вывода
Выведите q строк, i-я из которых должна содержать ответ на i-й запрос: «YES», в случае, если корабль вместимостью bi сможет добраться от отсека xi до отсека yi, и «NO» в противном случае.

Y. Пятнашки c восстановлением ответа
Ограничение времени	180 секунд
Ограничение памяти	4Gb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Написать алгоритм для решения игры в “пятнашки”. Решением задачи является приведение к виду: [ 1 2 3 4 ] [ 5 6 7 8 ] [ 9 10 11 12] [ 13 14 15 0 ], где 0 задает пустую ячейку. Необходимо найти минимальное решение.

Обратите внимание на ограничения! Потренируйтесь на предыдущей задаче перед решением этой.

Формат ввода
Начальная расстановка.

Формат вывода
Если вам удалось найти решение, то в первой строке файла выведите число перемещений, которое требуется сделать в вашем решении. А во второй строке выведите соответствующую последовательность ходов: L означает, что в результате перемещения костяшка сдвинулась влево, R – вправо, U – вверх, D – вниз. Если же выигрышная конфигурация недостижима, то выведите в выходной файл одно число −1.