A*. Приемная кампания
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Ваша цель — реализовать стабильную сортировку для следующей задачи.

Выведите фамилии и имена абитуриентов, подавших документы на поступление на ПМИ ФПМИ в порядке убывания их среднего балла по ЕГЭ.

Про каждого ученика известны их фамилии, имена и баллы ЕГЭ по следующим предметам: информатика, математика и русский язык.

Формат ввода
В первой строке идет число N (1 ≤ N ≤ 105) — количество абитуриентов, подавших документы.

Далее идет N строк — описания ученика в формате «surname name inf_points math_points rus_points», где «surname» и «name» — строки длины не более 40, а «*_points» — баллы за экзамены (целые числа от нуля до ста включительно).

Формат вывода
Необходимо вывести пары фамилия-имя по одной на строке, разделяя фамилию и имя одним пробелом. Выводить баллы не нужно. Если несколько учащихся имеют одинаковые средние баллы, то их нужно выводить в порядке, заданном во входных данных.

B*. Приоритетная очередь с удалением
Ограничение времени	1.5 секунд
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Требуется реализовать приоритетную очередь с помощью бинарной пирамиды, поддерживающую три операции: добавить элемент, извлечь максимальный элемент и удалить заданный элемент. При просеивании нельзя совершать лишние перемещения (например, в случае равенства элементов). Если при просеивании вниз, рассматриваемый элемент можно перемещать как влево вниз, так и вправо вниз, то следует выбрать направление влево.

Формат ввода
В первой строке вводятся два числа — максимальный размер приоритетной очереди N и количество запросов M, (1 ≤ M,N ≤ 105). Далее идут M строк, в каждой строке — по одному запросу. Первое число в запросе задает его тип, остальные числа (если есть) — параметры запроса. Тип 1 — извлечь максимальный (без параметров). Тип 2 — добавить данный элемент в очередь. Запрос имеет один параметр — число из диапазона [-109;109]. Тип 3 — удалить элемент по индексу (индексы нумеруются с единицы).

Формат вывода
В ответ на запрос типа 1 следует вывести: Если извлекать было нечего (очередь пуста), то -1. Иначе — два числа, первое — индекс конечного положения элемента после его просеивания (если удален последний элемент и просеивать нечего то вывести 0), второе — значение извлеченного элемента.

В ответ на запрос типа 2 следует вывести: Если добавить нельзя (нет места, т.к. в очередь уже N элементов), то -1. Иначе — индекс добавленного элемента.

В ответ на запрос типа 3 следует вывести: Если элемента с таким индексом нет и удаление невозможно, то -1. Иначе — значение удаленного элемента.

После выполнения всех запросов требуется вывести пирамиду в её конечном состоянии

C*. Высота дерева
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Реализуйте бинарное дерево поиска для целых чисел. Программа получает на вход последовательность целых чисел и строит из них дерево. Элементы в деревья добавляются в соответствии с результатом поиска их места. Если элемент уже существует в дереве, добавлять его не надо. Балансировка дерева не производится.

Формат ввода
На вход программа получает последовательность целых чисел. Последовательность завершается числом 0, которое означает конец ввода, и добавлять его в дерево не надо.

Формат вывода
Выведите единственное число – высоту получившегося дерева.

D*. Второй максимум
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Постройте бинарное дерево поиска и выведите второй по величине элемент в построенном дереве. Гарантируется, что такой найдется.

Формат ввода
Дана последовательность целых чисел, оканчивающаяся нулем. Сам ноль в последовательность не входит.

Формат вывода
Выведите ответ на задачу.

E*. Вывод листьев
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Реализуйте бинарное дерево поиска для целых чисел. Программа получает на вход последовательность целых чисел и строит из них дерево. Элементы в дерево добавляются последовательно в соответствии с их вводом. Если элемент уже существует в дереве, добавлять его не надо. Балансировка дерева не производится.

Для полученного дерева выведите список всех листьев (вершин, не имеющих потомков) в порядке возрастания.

Формат ввода
На вход программа получает последовательность целых чисел через пробел. В последовательности отсутствует число 0, а завершается она числом 0, которое означает конец ввода, и добавлять его в дерево не надо.

Количество элементов не превосходит 109

Формат вывода
Выведите ответ на задачу.

F*. Вывод развилок
Ограничение времени	1 секунда
Ограничение памяти	128Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Для полученного дерева выведите список всех вершин, имеющих по два ребёнка, в порядке возрастания.

Формат ввода
Вводится последовательность целых чисел, оканчивающаяся нулем. Сам ноль в последовательность не входит. Постройте по этой последовательности дерево.

Формат вывода
Выведите ответ задачи.

G*. Следующий (AVL)
Ограничение времени	1 секунда
Ограничение памяти	64.8 Мб
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Реализуйте структуру данных, которая поддерживает множество S целых чисел, с котором разрешается производить следующие операции:

a
d
d
(
i
)
add(i) — добавить в множество 
S
S число 
i
i (если он там уже есть, то множество не меняется);
n
e
x
t
(
i
)
next(i) — вывести минимальный элемент множества, не меньший 
i
i. Если искомый элемент в структуре отсутствует, необходимо вывести -1.
Формат ввода
Исходно множество 
S
S пусто. Первая строка входного файла содержит 
n
n — количество операций 
(
1
≤
n
≤
300000
)
(1≤n≤300000). Следующие 
n
n строк содержат операции. Каждая операция имеет вид либо <<+ 
i
i>>, либо <<
?
? 
i
i>>. Операция <<
?
? 
i
i>> задает запрос 
n
e
x
t
(
i
)
next(i).

Если операция <<+ 
i
i>> идет во входном файле в начале или после другой операции «+», то она задает операцию 
a
d
d
(
i
)
add(i). Если же она идет после запроса <<
?
?>>, и результат этого запроса был y, то выполняется операция 
a
d
d
(
(
i
+
y
)
(
m
o
d
1
0
9
)
)
add((i+y)(mod10 
9
 )).

Во всех запросах и операциях добавления параметры лежат в интервале от 0 до 
1
0
9
10 
9
 .

Формат вывода
Для каждого запроса выведите одно число~--- ответ на запрос.

H. Следующий (Splay)
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Реализуйте структуру данных, которая поддерживает множество S целых чисел, с котором разрешается производить следующие операции:

add(i) — добавить в множество S число i (если он там уже есть, то множество не меняется);
next(i) — вывести минимальный элемент множества, не меньший i. Если искомый элемент в структуре отсутствует, необходимо вывести -1.
Формат ввода
Исходно множество S пусто. Первая строка входного файла содержит n — количество операций (1≤ n≤ 300000). Следующие n строк содержат операции. Каждая операция имеет вид либо «+ i», либо «? i». Операция «? i» задает запрос next(i).

Если операция «+ i» идет во входном файле в начале или после другой операции «+», то она задает операцию add(i). Если же она идет после запроса «?», и результат этого запроса был y, то выполняется операция add((i + y) mod 109).

Во всех запросах и операциях добавления параметры лежат в интервале от 0 до 109.

Формат вывода
Для каждого запроса выведите одно число — ответ на запрос.

I. Гипершашки
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Андрей работает судьей на чемпионате по гипершашкам. В каждой игре в гипершашки участвует три игрока. По ходу игры каждый из игроков набирает некоторое положительное целое число баллов. Если после окончания игры первый игрок набрал a баллов, второй — b, а третий c, то говорят, что игра закончилась со счетом a:b:c. Андрей знает, что правила игры гипершашек устроены таким образом, что в результате игры баллы любых двух игроков различаются не более чем в k раз. После матча Андрей показывает его результат, размещая три карточки с очками игроков на специальном табло. Для этого у него есть набор из n карточек, на которых написаны числа x1, x2, …, xn. Чтобы выяснить, насколько он готов к чемпионату, Андрей хочет понять, сколько различных вариантов счета он сможет показать на табло, используя имеющиеся карточки. Требуется написать программу, которая по числу k и значениям чисел на карточках, которые имеются у Андрея, определяет количество различных вариантов счета, которые Андрей может показать на табло.

Формат ввода
Первая строка входного файла содержит два целых числа: n и k (3 ≤ n ≤ 100 000, 1 ≤ k ≤ 109). Вторая строка входного файла содержит n целых чисел x1, x2, …, xn (1 ≤ xi ≤ 109).

J. Башня из коробок
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Недавно у Сережи был день рождения, и его друзья, зная, как ему нравится строить башни, подарили ему N коробок. Сережа живет в 2D мире, поэтому коробки представляют из себя прямоугольники со сторонами, параллельными осям координат. Сережа также умеет поворачивать коробки на 90 градусов.

Как уже было сказано, Сережа очень любит башни, но не все башни нравятся ему одинаково. Больше всего ему нравятся высокие башни, поэтому он хочет построить как можно более высокую башню из тех коробок, которые ему подарили. Башню можно строить, ставя коробки друг на друга. Для устойчивости башни нужно, чтобы ширина любой коробки была не больше, чем ширина той, на которой она стоит.

Напишите программу, которая вычислит, какой максимальной высоты устойчивую башню он может построить.

K. Нерекурсивный обход
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Постройте бинарное дерево поиска по заданной последовательности, а затем выведите все элементы полученного дерева в порядке возрастания. В отличие от предыдущей задачи реализуйте нерекурсивный алгоритм обхода (с O(1) доп. памяти).

Формат ввода
Вводится последовательность целых чисел, оканчивающаяся нулем. Сам ноль в последовательность не входит.

Формат вывода
Выведите ответ на задачу.

L. Восстановление дерева
Ограничение времени	1.5 секунд
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Дан массив pre-order обхода некоторого бинарного дерева поиска. Восстановите по данной последовательности исходное дерево.

Формат ввода
Вводится количество чисел в последовательности (не более 100,000), затем сама последовательность целых чисел.

Формат вывода
Выведите массив post-order обхода восстановленного дерева

M. Минимакс
Ограничение времени	2 секунды
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Реализуйте структуру данных, способную выполнять операции ниже. Напишите программу, реализовав все указанные здесь методы. Возможные команды для программы:

insert n — добавить в структуру число n (1 ≤ n ≤ 109) (значение n задается после команды). Программа должна вывести ok.
extract_min — удалить из структуры минимальный элемент. Программа должна вывести его значение.
get_min — программа должна вывести значение минимального элемента, не удаляя его из структуры.
extract_max — удалить из структуры максимальный элемент. Программа должна вывести его значение.
get_max — программа должна вывести значение миаксимального элемента, не удаляя его из структуры.
size — программа должна вывести количество элементов в структуре.
clear — Программа должна очистить структуру и вывести ok.
Если во входных данных встречается операция extract_min, extract_max, get_min или get_max, и при этом в структуре нет ни одного элемента, то программа должна вместо числового значения вывести строку error.

Формат ввода
В первой строке входных данных записано единственное число M (1 ≤ M ≤ 2 ⋅ 105) — количество команд.

В следующих М строках дано по одной команде из тех, что идут выше.

Формат вывода
Для каждой команды выведите одну строчку — результат ее выполнения.

N. MinMidMax
Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Реализуйте структуру данных для хранения различных целых чисел, которая поддерживает 4 операции:

«add x> — Добавить в структуру элемент x (1 ≤ x ≤ 109);
«min» — Извлечь из структуры минимальный элемент;
«max» — Извлечь из структуры максимальный элемент;
«mid» — Извлечь из структуры медианный элемент (в случае чётности размера структуры следует вывести левый медианный элемент, то есть если в структуре хранится n элементов a0 ≤ a1 ≤ … ≤ an-1, то процедура извлекает элемент ).
Формат ввода
В первой строке входных данных записано единственное число M (1 ≤ M ≤ 200000) — количество команд. В следующих М строках дано по одной команде из тех, что идут выше.

Формат вывода
На каждый запрос «min», «max» и «mid» выведите значение извлечённого элемента.

O. Менеджер памяти
Ограничение времени	1 секунда
Ограничение памяти	256Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Пете поручили написать менеджер памяти для новой стандартной библиотеки языка H++. В распоряжении у менеджера находится массив из N последовательных ячеек памяти, пронумерованных от 1 до N. Задача менеджера — обрабатывать запросы приложений на выделение и освобождение памяти.

Запрос на выделение памяти имеет один параметр K. Такой запрос означает, что приложение просит выделить ему K последовательных ячеек памяти. Если в распоряжении менеджера есть хотя бы один свободный блок из K последовательных ячеек, то он обязан в ответ на запрос выделить такой блок. При этом непосредственно перед самой первой ячейкой памяти выделяемого блока не должно располагаться свободной ячейки памяти. Если в памяти доступно несколько таких блоков, то выбирается блок, принадлежащий самой длинной непрерывной последовательности пустых ячеек. Если и таких блоков несколько, то выбирается самый левый из них. После этого выделенные ячейки становятся занятыми и не могут быть использованы для выделения памяти, пока не будут освобождены. Если блока из K последовательных свободных ячеек нет, то запрос отклоняется.

Запрос на освобождение памяти имеет один параметр T. Такой запрос означает, что менеджер должен освободить память, выделенную ранее при обработке запроса с порядковым номером T. Запросы нумеруются, начиная с единицы. Гарантируется, что запрос с номером T — запрос на выделение, причем к нему еще не применялось освобождение памяти. Освобожденные ячейки могут снова быть использованы для выделения памяти. Если запрос с номером T был отклонен, то текущий запрос на освобождение памяти игнорируется.

Требуется написать менеджер памяти, удовлетворяющий приведенным критериям.

Формат ввода
Первая строка входного файла содержит числа N и M — количество ячеек памяти и количество запросов соответственно (1 ≤ N ≤ 231 - 1; 1 ≤ M ≤ 105). Каждая из следующих M строк содержит по одному числу: (i + 1)-я строка входного файла (1 ≤ i ≤ M) содержит либо положительное число K, если i-й запрос — запрос на выделение с параметром K (1 ≤ K ≤ N), либо отрицательное число -T, если i-й запрос — запрос на освобождение с параметром T (1 ≤ T ≤ i).

Формат вывода
Для каждого запроса на выделение памяти выведите в выходной файл результат обработки этого запроса: для успешных запросов выведите номер первой ячейки памяти в выделенном блоке, для отклоненных запросов выведите число «-1». Результаты нужно выводить в порядке следования запросов во входном файле.